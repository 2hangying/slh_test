/**
 * 翻页检验
 * @param title 有一些标题需要限制条件，如款号,需要先用查询条件限制门店，防止不同门店的相同款号
 * @param index 限制条件的下标 若数据只有1页，删除限制条件，重新查询，只验证序号
 * @param firstTitle
 * @param titleTotal
 */
function goPageCheck(firstTitle, titleTotal, title, index) {
    if (isUndefined(title)) {
        title = "序号";
    }
    // 当前页为1
    var qr = getQR();
    var totalPageNo = qr.totalPageNo;
    var i, j, ret = true;

    // 清除限制的查询条件再查询一次
    if (totalPageNo <= 1) {
        title = "序号";
        if (isDefined(index)) {
            tap(window.textFields()[index]);
            var pop = window.popover();
            if (!isUIAElementNil(pop)) {
                pop.dismiss(); // TF_SC
            }
            var ok = tap(window.textFields()[index].buttons()["清除文本"]);
            if (!ok) {
                tap(window.textFields()[index].buttons()["Clear text"]);
            }
        }
        tapButton(window, QUERY);
        qr = getQR();
        totalPageNo = qr.totalPageNo;
    }

    if (totalPageNo > 1) {
        var page1 = new Array();
        for (i = 0; i < qr.curPageTotal; i++) {
            page1[i] = qr.data[i][title];
        }
        // 总页数验证
        ret = isAnd(ret, isEqual(Math.ceil(qr.total / 15), totalPageNo));

        // 最后一页验证
        goPage(totalPageNo, qr);
        qr = getQR();
        var page2 = new Array();
        for (i = 0; i < qr.curPageTotal; i++) {
            page2[i] = qr.data[i][title];
        }
        var finSeq = qr.curPageTotal - 1;
        // 最后的序号应该等于总数据条数
        ret = isAnd(ret, isEqual(qr.total, qr.data[finSeq]["序号"]), isEqual(
                totalPageNo, qr.curPageNo), isHasSame(page1, page2),
                scrollPrevPageCheck(firstTitle, titleTotal));

        // 当总页数大于2时，追加一页验证
        if (totalPageNo > 2) {
            qr = getQR();
            var midPage = Math.ceil(totalPageNo / 2);
            logDebug("midPage=" + midPage);
            // 输入值页面切换
            goPage2(midPage, qr);
            qr = getQR();
            var curPageNo = qr.curPageNo;
            var firstSeq = (curPageNo - 1) * 15 + 1;
            var page3 = new Array();
            for (i = 0; i < qr.curPageTotal; i++) {
                page3[i] = qr.data[i][title];
            }
            ret = isAnd(ret, isEqual(firstSeq, qr.data[0]["序号"]), isEqual(
                    midPage, qr.curPageNo), scrollPrevPageCheck(firstTitle,
                    titleTotal), isHasSame(page1, page3), isHasSame(page2,
                    page3));

            qr = getQR();
            goPage(1, qr);
        }

    } else {
        // 只有一页的时候，滑动页面，检测有没有提示错误
        scrollPrevPage();
        scrollNextPage();
        goPage(1,qr);
    }

    return ret;
}